<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Degree Requests</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 42px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 18px;
            opacity: 0.9;
        }

        .controls {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            background: #f0f0f0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
            text-align: center;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .tab-btn:hover:not(.active) {
            background: #e0e0e0;
            transform: translateY(-1px);
        }

        .filter-form {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .filter-form.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 8px;
            color: #555;
            font-weight: 600;
            font-size: 14px;
        }

        input,
        select {
            padding: 12px 15px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
            box-shadow: 0 8px 20px rgba(108, 117, 125, 0.3);
        }

        .results {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .results-header h2 {
            color: #333;
            font-size: 24px;
        }

        .pagination {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .page-btn {
            padding: 8px 16px;
            background: #f0f0f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn.active {
            background: #667eea;
            color: white;
        }

        .page-btn:hover:not(.active) {
            background: #e0e0e0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        tr:hover {
            background: #f8f9ff;
        }

        .status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status.pending {
            background: #fff3cd;
            color: #856404;
        }

        .status.approved {
            background: #d4edda;
            color: #155724;
        }

        .status.rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 20px;
            display: block;
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .nav-link {
            background: white;
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            padding: 12px 24px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üìã Degree Requests Dashboard</h1>
            <p>View and filter degree requests from the system</p>
        </div>

        <div class="controls">
            <div class="tabs">
                <button class="tab-btn active" data-tab="university">By University</button>
                <button class="tab-btn" data-tab="university-status">University & Status</button>
                <button class="tab-btn" data-tab="student">By Student</button>
                <button class="tab-btn" data-tab="student-status">Student & Status</button>
                <button class="tab-btn" data-tab="status">By Status</button>
            </div>

            <!-- University Filter -->
            <form id="universityForm" class="filter-form active">
                <div class="form-row">
                    <div class="form-group">
                        <label for="universityId">University ID (UUID)</label>
                        <input type="text" id="universityId" placeholder="Enter UUID"
                            value="550e8400-e29b-41d4-a716-446655440000">
                    </div>
                    <div class="form-group">
                        <label for="page">Page</label>
                        <input type="number" id="page" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="size">Page Size</label>
                        <select id="size">
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="sortBy">Sort By</label>
                        <select id="sortBy">
                            <option value="createdAt" selected>Created Date</option>
                            <option value="studentName">Student Name</option>
                            <option value="cgpa">CGPA</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sortDir">Sort Direction</label>
                        <select id="sortDir">
                            <option value="desc" selected>Descending</option>
                            <option value="asc">Ascending</option>
                        </select>
                    </div>
                </div>
                <button type="button" class="btn" onclick="loadUniversityRequests()">Load Requests</button>
            </form>

            <!-- University & Status Filter -->
            <form id="universityStatusForm" class="filter-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="universityId2">University ID</label>
                        <input type="text" id="universityId2" placeholder="Enter UUID"
                            value="550e8400-e29b-41d4-a716-446655440000">
                    </div>
                    <div class="form-group">
                        <label for="status1">Status</label>
                        <select id="status1">
                            <option value="PENDING">PENDING</option>
                            <option value="APPROVED">APPROVED</option>
                            <option value="REJECTED">REJECTED</option>
                            <option value="IN_REVIEW">IN_REVIEW</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="page2">Page</label>
                        <input type="number" id="page2" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="size2">Page Size</label>
                        <select id="size2">
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                        </select>
                    </div>
                </div>
                <button type="button" class="btn" onclick="loadUniversityStatusRequests()">Load Requests</button>
            </form>

            <!-- Student Filter -->
            <form id="studentForm" class="filter-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="studentId">Student ID (UUID)</label>
                        <input type="text" id="studentId" placeholder="Enter UUID"
                            value="110e8400-e29b-41d4-a716-446655440000">
                    </div>
                    <div class="form-group">
                        <label for="page3">Page</label>
                        <input type="number" id="page3" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="size3">Page Size</label>
                        <select id="size3">
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                        </select>
                    </div>
                </div>
                <button type="button" class="btn" onclick="loadStudentRequests()">Load Requests</button>
            </form>

            <!-- Student & Status Filter -->
            <form id="studentStatusForm" class="filter-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="studentId2">Student ID</label>
                        <input type="text" id="studentId2" placeholder="Enter UUID"
                            value="110e8400-e29b-41d4-a716-446655440000">
                    </div>
                    <div class="form-group">
                        <label for="status2">Status</label>
                        <select id="status2">
                            <option value="PENDING">PENDING</option>
                            <option value="APPROVED">APPROVED</option>
                            <option value="REJECTED">REJECTED</option>
                            <option value="IN_REVIEW">IN_REVIEW</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="page4">Page</label>
                        <input type="number" id="page4" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="size4">Page Size</label>
                        <select id="size4">
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                        </select>
                    </div>
                </div>
                <button type="button" class="btn" onclick="loadStudentStatusRequests()">Load Requests</button>
            </form>

            <!-- Status Filter -->
            <form id="statusForm" class="filter-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="status3">Status</label>
                        <select id="status3">
                            <option value="PENDING">PENDING</option>
                            <option value="APPROVED">APPROVED</option>
                            <option value="REJECTED">REJECTED</option>
                            <option value="IN_REVIEW">IN_REVIEW</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="page5">Page</label>
                        <input type="number" id="page5" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="size5">Page Size</label>
                        <select id="size5">
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                        </select>
                    </div>
                </div>
                <button type="button" class="btn" onclick="loadStatusRequests()">Load Requests</button>
            </form>
        </div>

        <div class="results">
            <div class="results-header">
                <h2>Results</h2>
                <div class="pagination" id="pagination">
                    <!-- Pagination will be generated here -->
                </div>
            </div>

            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Loading requests...</p>
            </div>

            <div id="emptyState" class="empty-state" style="display: none;">
                <div>üì≠</div>
                <h3>No requests found</h3>
                <p>Try changing your filter criteria</p>
            </div>

            <table id="resultsTable" style="display: none;">
                <thead>
                    <tr>
                        <th>Student Name</th>
                        <th>University</th>
                        <th>Program</th>
                        <th>Roll Number</th>
                        <th>Passing Year</th>
                        <th>CGPA</th>
                        <th>Status</th>
                        <th>HEC Stamped</th>
                        <th>Request Date</th>
                        <th>Remarks</th>
                    </tr>
                </thead>
                <tbody id="resultsBody">
                    <!-- Results will be populated here -->
                </tbody>
            </table>
        </div>

        <div class="nav-links">
            <a href="index.html" class="nav-link">‚ûï Create New Request</a>
            <a href="#" onclick="showSampleRequests()" class="nav-link">üé≤ Load Sample Data</a>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all tabs
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.filter-form').forEach(f => f.classList.remove('active'));

                // Add active class to clicked tab
                btn.classList.add('active');
                const tabId = btn.dataset.tab;
                document.getElementById(`${tabId}Form`).classList.add('active');
            });
        });

        // Current state
        let currentData = null;
        let currentFilter = 'university';
        let currentPage = 0;
        let currentSize = 10;

        // University requests
        async function loadUniversityRequests() {
            currentFilter = 'university';
            currentPage = parseInt(document.getElementById('page').value);
            currentSize = parseInt(document.getElementById('size').value);

            const universityId = document.getElementById('universityId').value;
            const sortBy = document.getElementById('sortBy').value;
            const sortDir = document.getElementById('sortDir').value;

            await executeRequest(
                getByUniversity(universityId, currentPage, currentSize, sortBy, sortDir)
            );
        }

        // University and status requests
        async function loadUniversityStatusRequests() {
            currentFilter = 'university-status';
            currentPage = parseInt(document.getElementById('page2').value);
            currentSize = parseInt(document.getElementById('size2').value);

            const universityId = document.getElementById('universityId2').value;
            const status = document.getElementById('status1').value;
            const sortBy = 'createdAt';
            const sortDir = 'desc';

            await executeRequest(
                getByUniversityAndStatus(universityId, status, currentPage, currentSize, sortBy, sortDir)
            );
        }

        // Student requests
        async function loadStudentRequests() {
            currentFilter = 'student';
            currentPage = parseInt(document.getElementById('page3').value);
            currentSize = parseInt(document.getElementById('size3').value);

            const studentId = document.getElementById('studentId').value;
            const sortBy = 'createdAt';
            const sortDir = 'desc';

            await executeRequest(
                getByStudent(studentId, currentPage, currentSize, sortBy, sortDir)
            );
        }

        // Student and status requests
        async function loadStudentStatusRequests() {
            currentFilter = 'student-status';
            currentPage = parseInt(document.getElementById('page4').value);
            currentSize = parseInt(document.getElementById('size4').value);

            const studentId = document.getElementById('studentId2').value;
            const status = document.getElementById('status2').value;
            const sortBy = 'createdAt';
            const sortDir = 'desc';

            await executeRequest(
                getByStudentAndStatus(studentId, status, currentPage, currentSize, sortBy, sortDir)
            );
        }

        // Status requests
        async function loadStatusRequests() {
            currentFilter = 'status';
            currentPage = parseInt(document.getElementById('page5').value);
            currentSize = parseInt(document.getElementById('size5').value);

            const status = document.getElementById('status3').value;
            const sortBy = 'createdAt';
            const sortDir = 'desc';

            await executeRequest(
                getByStatus(status, currentPage, currentSize, sortBy, sortDir)
            );
        }

        // Execute request and handle results
        async function executeRequest(promise) {
            showLoading(true);

            try {
                const pageData = await promise;
                currentData = pageData;
                displayResults(pageData);
                setupPagination(pageData);
            } catch (error) {
                console.error('Failed to load requests:', error);
            } finally {
                showLoading(false);
            }
        }

        // Display results in table
        function displayResults(pageData) {
            const tbody = document.getElementById('resultsBody');
            tbody.innerHTML = '';

            if (!pageData || !pageData.content || pageData.content.length === 0) {
                document.getElementById('resultsTable').style.display = 'none';
                document.getElementById('emptyState').style.display = 'block';
                document.getElementById('pagination').innerHTML = '';
                return;
            }

            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('resultsTable').style.display = 'table';

            pageData.content.forEach(request => {
                const row = document.createElement('tr');

                // Format status with color
                const statusClass = request.status.toLowerCase();
                const statusHtml = `<span class="status ${statusClass}">${request.status}</span>`;

                // Format HEC stamped
                const hecStamped = request.stampedByHec ? '‚úÖ Yes' : '‚ùå No';

                // Format date
                const requestDate = request.requestDate ? formatDate(request.requestDate) : 'N/A';

                row.innerHTML = `
                    <td>${request.studentName || 'N/A'}</td>
                    <td>${request.universityName || 'N/A'}</td>
                    <td>${request.program || 'N/A'}</td>
                    <td>${request.rollNumber || 'N/A'}</td>
                    <td>${request.passingYear || 'N/A'}</td>
                    <td>${request.cgpa || 'N/A'}</td>
                    <td>${statusHtml}</td>
                    <td>${hecStamped}</td>
                    <td>${requestDate}</td>
                    <td>${request.remarks || 'No remarks'}</td>
                `;

                tbody.appendChild(row);
            });
        }

        // Setup pagination
        function setupPagination(pageData) {
            const paginationDiv = document.getElementById('pagination');

            if (!pageData || pageData.totalPages <= 1) {
                paginationDiv.innerHTML = '';
                return;
            }

            let paginationHTML = '';

            // Previous button
            if (pageData.number > 0) {
                paginationHTML += `<button class="page-btn" onclick="goToPage(${pageData.number - 1})">‚Üê Prev</button>`;
            }

            // Page numbers
            for (let i = 0; i < pageData.totalPages; i++) {
                if (i === pageData.number) {
                    paginationHTML += `<button class="page-btn active">${i + 1}</button>`;
                } else if (i === 0 || i === pageData.totalPages - 1 || Math.abs(i - pageData.number) <= 2) {
                    paginationHTML += `<button class="page-btn" onclick="goToPage(${i})">${i + 1}</button>`;
                } else if (Math.abs(i - pageData.number) === 3) {
                    paginationHTML += `<span style="padding: 0 5px;">...</span>`;
                }
            }

            // Next button
            if (pageData.number < pageData.totalPages - 1) {
                paginationHTML += `<button class="page-btn" onclick="goToPage(${pageData.number + 1})">Next ‚Üí</button>`;
            }

            paginationDiv.innerHTML = paginationHTML;
        }

        // Go to specific page
        function goToPage(page) {
            currentPage = page;

            // Update the appropriate form
            switch (currentFilter) {
                case 'university':
                    document.getElementById('page').value = page;
                    loadUniversityRequests();
                    break;
                case 'university-status':
                    document.getElementById('page2').value = page;
                    loadUniversityStatusRequests();
                    break;
                case 'student':
                    document.getElementById('page3').value = page;
                    loadStudentRequests();
                    break;
                case 'student-status':
                    document.getElementById('page4').value = page;
                    loadStudentStatusRequests();
                    break;
                case 'status':
                    document.getElementById('page5').value = page;
                    loadStatusRequests();
                    break;
            }
        }

        // Show/hide loading
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        // Load sample data on page load
        function showSampleRequests() {
            loadUniversityRequests();
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function () {
            // Load initial data
            showSampleRequests();
        });
    </script>
</body>

</html>